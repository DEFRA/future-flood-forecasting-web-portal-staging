<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
  <changeSet author="awallace" id="changelog-add-additional-location-columns-to-coastal-forecast-location-table">
    <sql>
      IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_X') IS NULL
        ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION ADD LOCATION_X INT NOT NULL
      IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_Y') IS NULL
        ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION ADD LOCATION_Y INT NOT NULL
      IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_Z') IS NULL
        ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION ADD LOCATION_Z INT NULL
      IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION', 'FFFS_LOC_NAME') &lt;= 128
        ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION ALTER COLUMN FFFS_LOC_NAME NVARCHAR(MAX)
    </sql>
    <rollback>
      <sql>
        IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_X') IS NOT NULL
          ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION DROP COLUMN LOCATION_X
        IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_Y') IS NOT NULL
          ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION DROP COLUMN LOCATION_Y
        IF COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION','LOCATION_Z') IS NOT NULL
          ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION DROP COLUMN LOCATION_Z
        IF (COL_LENGTH('FFF_STAGING.COASTAL_FORECAST_LOCATION', 'FFFS_LOC_NAME')) &gt; 128
          ALTER TABLE FFF_STAGING.COASTAL_FORECAST_LOCATION ALTER COLUMN FFFS_LOC_NAME NVARCHAR(64) NULL
      </sql>
    </rollback>
  </changeSet>
</databaseChangeLog>
